var give_global_vars,give_tributes_public_strings,Give_Tribute,give_tributes_common_vars;jQuery(document).ready(function(e){var t=e("body");t.on("change",'input[name="give_tributes_show_dedication"]:radio',function(){var t=e(this).closest("form.give-form");0===t.length&&(t=e(this).closest("#give_md_create_payment"),t||(t=e(this).parents("form"))),Give_Tribute.give_tributes_show_dedication(t)}).change(),t.on("change",'input[name="give_tributes_would_to"]:radio',function(){var t=e(this).closest("form.give-form");0===t.length&&(t=e(this).closest("#give_md_create_payment"),t||(t=e(this).parents("form"))),Give_Tribute.give_tributes_would_to(t)}).change(),t.on("change",'select[name="give_tributes_address_country"]',function(){var t=e(this),i=t.closest("form.give-form");0===i.length&&(i=e(this).closest("#give_md_create_payment")),Give_Tribute.give_tributes_address_country(i)}).change(),t.on("change touchend click",".give-tribute-type-button, .give-tribute-type-radio, .give-tributes-type-select",function(){var t=e(this).val(),i=e(this).closest("form.give-form"),s=e(this);i||(i=e(this).parents("form")),0===i.length&&(i=e(this).closest("#give_md_create_payment"),e(this).hasClass("give-tribute-type-button")&&(e(i).find(".give-tribute-type-button").each(function(t,i){e(this).removeClass("active")}),s.addClass("active"))),i.find(".give-tributes-type").val(t)}),t.on("keyup change",'textarea.give-tributes-personalized-message, textarea[name="give-tributes-mail-card-personalized-message"]',function(){var t=e(this);t.closest(".give_tributes_send_ecard_fields").find(".give-tributes-ecard-personalized-message-left").text(parseInt(t.attr("maxlength"))-t.val().length+" "+give_tributes_common_vars.give_tribute_characters_left)}),t.on("keyup change",'textarea[name="give-tributes-mail-card-personalized-message"]',function(){var t=e(this);t.closest(".give_tributes_mail_card_personalized_message").find(".give-tributes-mail-card-personalized-message-left").text(parseInt(t.attr("maxlength"))-t.val().length+" "+give_tributes_common_vars.give_tribute_characters_left)}),e(document).on("click","span.give-tributes-clone-field",function(t){t.preventDefault();var i=e(this).closest("form.give-form"),s=e(this).closest(".give-tributes-notification-lists");0===i.length&&(i=e(this).closest("#give_md_create_payment"),i||(i=e(this).parents("form")));var r=jQuery(this).data("action"),a=e(this).closest(".give_tributes_send_ecard_fields"),n=s.find(".give_tributes_send_ecard_fields").length,o=a.find("textarea.give-tributes-personalized-message").attr("maxlength"),d=i.find('input[name="give-form-id"]').val(),_=0;if("add"===r){if(n>=5)return alert(give_tributes_public_strings.give_tribute_receipt_limit_exceed),!1;_+=1,a='<div id="give-tributes-send-ecard-fields-'+d+"-recipient-"+_+'" class="'+a.attr("class")+' cloned-field" >'+a.html()+"</div>";var v=s.append(a),u=jQuery("#give-tributes-send-ecard-fields-"+d+"-recipient-"+_);u.find(".give-label").each(function(t,i){var s=e(this),r=s.attr("for"),a=r+"-"+_;e(this).attr("for",a),u.find("input#"+r+",textarea#"+r).attr("id",a)});var g=v.find(".cloned-field .give-tributes-ecard-personalized-message-left");g.length>0&&g.html(g.html().replace(/\d+/,o)),v.find(".cloned-field input").val("").closest(".cloned-field").removeClass("cloned-field"),e(this).closest("#give_md_create_payment")||give_fl_trigger()}else if("remove"===r){if(n<=1)return!1;jQuery(this).closest(".give_tributes_send_ecard_fields").remove()}Give_Tribute.remove_cross_sign()}),Give_Tribute={init:function(){var t=e("form.give-form");0===t.length?(Give_Tribute.initial_trigger(e("#give_md_create_payment")),e("#give_md_create_payment").find("button.give-tribute-type-button").each(function(t,i){0===t&&e(this).addClass("active"),e(this).addClass("button")})):t.each(function(){Give_Tribute.initial_trigger(e(this))})},initial_trigger:function(e){Give_Tribute.give_tributes_show_dedication(e),Give_Tribute.give_tributes_would_to(e),Give_Tribute.remove_cross_sign()},give_tributes_show_dedication:function(t){var i=Give_Tribute.getFormID(t),s=t.find('input[name="give_tributes_show_dedication"]:radio:checked').val(),r=t.find("#give-tributes-type-wrap-"+i),a=t.find("#give-tributes-info-wrap-"+i),n=t.find("#give-tributes-grab-info-wrap-"+i),o=t.find("#give-tributes-mail-card-fields-"+i),d=t.find("#give-tributes-notification-list-"+i),_=t.find(".give-tributes-type-button-list li:first button").val(),v=e("#give_md_create_payment tr.give-tributes-row.give-tributes-email-option");r.hasClass("has_radios")?_=t.find('input[name="give_tributes_radio_type"]:radio:checked').val():r.hasClass("has_dropdown")&&(_=t.find(".give-tributes-type-select option:first").val());var u=t.find(".give-tributes-type-"+i);u.val(_),"no"===s?(r.hide(),a.hide(),n.hide(),o.hide(),d.hide(),v.hide(),r.closest("tr.give-tributes-row").hide(),a.closest("tr.give-tributes-row").hide(),n.closest("tr.give-tributes-row").hide(),o.closest("tr.give-tributes-row").hide(),d.closest("tr.give-tributes-row").hide()):(r.show(),a.show(),n.show(),o.show(),d.show(),v.show(),r.closest("tr.give-tributes-row").show(),a.closest("tr.give-tributes-row").show(),n.closest("tr.give-tributes-row").show(),o.closest("tr.give-tributes-row").show(),d.closest("tr.give-tributes-row").show(),e('input[name="give_tributes_would_to"]:radio').trigger("change"))},give_tributes_would_to:function(t){var i=Give_Tribute.getFormID(t),s=t.find("#give-tributes-grab-info-wrap-"+i+' input[name="give_tributes_would_to"]:radio:checked').val(),r=t.find("#give-tributes-mail-card-fields-"+i),a=t.find(".give-tributes-notification-lists"),n=e("#give_md_create_payment tr.give-tributes-row.give-tributes-email-option");"send_eCard"===s?(a.show(),a.closest("tr.give-tributes-row").show(),r.hide(),r.closest("tr.give-tributes-row").show(),n.show()):"send_mail_card"===s?(a.hide(),r.show(),a.closest("tr.give-tributes-row").show(),n.hide()):(a.hide(),r.hide(),r.closest("tr.give-tributes-row").hide(),a.closest("tr.give-tributes-row").hide(),n.hide())},give_tributes_address_country:function(t){var i=Give_Tribute.getFormID(t),s=t.find("#give-tributes-mail-card-state-"+i),r=t.find("#give_tributes_address_country_"+i).val();if("undefined"!=typeof r&&""!==r){var a={action:"give_get_states",country:r,field_name:"give_tributes_address_state",form_id:i};e.post(give_tributes_common_vars.ajax_url,a,function(e){s.find("*").not(".give_tributes_address_state_label, span").remove(),s.removeClass("give-hidden"),t.find(".give_tributes_adjust_zip").removeClass("form-row-wide"),t.find(".give_tributes_adjust_zip").addClass("form-row-last"),"undefined"!=typeof e.states_found&&!0===e.states_found?s.append(e.data):(s.append('<input aria-required="true" name="give_tributes_address_state" id="give_tributes_address_state_'+i+'" class="text give-input required" type="text" value="" />'),"undefined"!=typeof e.show_field&&!1===e.show_field&&(s.addClass("give-hidden"),t.find(".give_tributes_adjust_zip").addClass("form-row-wide"),t.find(".give_tributes_adjust_zip").removeClass("form-row-last")))})}},getFormID:function(e){var t=e.find('input[name="give-form-id"]').val();return void 0===t&&(t=jQuery('select[name="forms[id]"]').val()),t},remove_cross_sign:function(){var t=jQuery(".give_tributes_send_ecard_fields");t.each(function(i){e(this).find(".give-icon-minus").parent().show(),0===i&&1===t.length&&e(this).find(".give-icon-minus").parent().hide()})}},Give_Tribute.init()});