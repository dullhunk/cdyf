(function($){$(document).ready(function(){const init=function initStickySidebarAd(el){const $large_sidebar_ad=el;const $parent_column=$large_sidebar_ad.closest(".fl-col");const $adjacent_column=$large_sidebar_ad.closest(".fl-col").next();const is_left_column=$parent_column.is(':first-child');const sidebar_ad_min_distance_from_top_tablet=10;const sidebar_ad_min_distance_from_top_desktop=10+jQuery('#header_main_row').height()+jQuery('.top_banner_strip').height()+jQuery('#wpadminbar').height();const parent_column_min_position_change_range=200;let vertical_scroll_position_to_start_sticking;let sidebar_ad_min_distance_from_top;let sidebar_ad_top_offset_within_column;let parent_column_top_sticky_position;let parent_column_bottom_sticky_position;let parent_column_default_position;let parent_column_right_offset;let parent_column_left_offset;let stored_parent_column_height=$parent_column.height();let stored_document_height=jQuery(document).height();const isMobile=()=>$(window).width()<=768;const isSticky=($element)=>$element.hasClass('stickySidebarAd');const isStickyBottom=($element)=>$element.hasClass('stickySidebarAd--bottom');const makeColumnSticky=($column,column_top_sticky_position)=>{$column.addClass('stickySidebarAd');const parent_column_width=$column[0].getBoundingClientRect().width;if(is_left_column){$column.css({'position':'fixed','top':column_top_sticky_position,'left':parent_column_left_offset,'bottom':'','width':parent_column_width});$adjacent_column.css({'position':'relative','left':parent_column_width,});}
else{$column.css({'position':'fixed','top':column_top_sticky_position,'right':parent_column_right_offset,'bottom':'','width':parent_column_width});}}
const makeColumnStickToBottom=($column)=>{$column.addClass('stickySidebarAd--bottom');$column.css({'position':'absolute','top':'','bottom':0});if($(window).width()>991){if(is_left_column){$column.css({'left':0,});}
else{$column.css({'right':0,});}}
else{if(is_left_column){$column.css({'left':0,});}
else{$column.css({'right':parent_column_right_offset,});}}}
const unstickColumn=($column)=>{$column.removeClass('stickySidebarAd');$column.css({'position':'','top':'','right':'','left':'','width':'','bottom':''});if(is_left_column){$adjacent_column.css({'position':'','left':'',});}}
const columnHighToLowDistanceRangeIsLargeEnough=()=>{const vertical_distance_between_parent_column_default_and_fixed_bottom_positions=parent_column_bottom_sticky_position-parent_column_default_position;const position_range_is_large_enough=vertical_distance_between_parent_column_default_and_fixed_bottom_positions>=parent_column_min_position_change_range;return position_range_is_large_enough?1:0;}
const resetVars=()=>{const setColumnPositionVars=($column)=>{$column.css({'position':'absolute','bottom':'0'});parent_column_bottom_sticky_position=$column.offset().top;$column.css({'position':'','bottom':''});parent_column_default_position=$column.offset().top;parent_column_right_offset=$(window).width()-($column.offset().left+$column.outerWidth());parent_column_left_offset=$column.offset().left;}
stored_document_height=jQuery(document).height();sidebar_ad_min_distance_from_top=$(window).width()<=991?sidebar_ad_min_distance_from_top_tablet:sidebar_ad_min_distance_from_top_desktop;sidebar_ad_top_offset_within_column=$large_sidebar_ad.offset().top-$parent_column.offset().top;parent_column_top_sticky_position=sidebar_ad_min_distance_from_top-sidebar_ad_top_offset_within_column;if(!isSticky($parent_column)){vertical_scroll_position_to_start_sticking=sidebar_ad_top_offset_within_column+$parent_column.offset().top-sidebar_ad_min_distance_from_top;setColumnPositionVars($parent_column);}
else{$parent_column.css({'position':'','top':'','right':'','width':'','bottom':''});setColumnPositionVars($parent_column);vertical_scroll_position_to_start_sticking=sidebar_ad_top_offset_within_column+$parent_column.offset().top-sidebar_ad_min_distance_from_top;if(isStickyBottom($parent_column))makeColumnStickToBottom($parent_column);else if(isSticky($parent_column))makeColumnSticky($parent_column,parent_column_top_sticky_position);}}
const resetVarsAndAdjustPosition=()=>{const adjustPosition=()=>{if(!columnHighToLowDistanceRangeIsLargeEnough()){unstickColumn($parent_column);return;}
if(isStickyBottom($parent_column))makeColumnStickToBottom($parent_column);else if(isSticky($parent_column))makeColumnSticky($parent_column,parent_column_top_sticky_position);}
if(isMobile()){unstickColumn($parent_column);$parent_column.removeClass('stickySidebarAd--bottom');return;}
resetVars();adjustPosition();}
const onScroll=()=>{if(isMobile())return;const documentHeightHasChanged=stored_document_height!=jQuery(document).height();if(documentHeightHasChanged)resetVarsAndAdjustPosition();if(!isSticky($parent_column)){if(!columnHighToLowDistanceRangeIsLargeEnough())return;}
const scrolled_distance=$(window).scrollTop();const parent_column_distance_from_top=$parent_column.offset().top-scrolled_distance;const parentColumnHeightHasChanged=stored_parent_column_height!=$parent_column.height();if(parentColumnHeightHasChanged){resetVarsAndAdjustPosition();stored_parent_column_height=$parent_column.height();}
const parent_column_position_is_past_sticking_point=parent_column_distance_from_top<parent_column_top_sticky_position;const parent_column_position_is_past_sticking_point_and_not_yet_sticky=parent_column_position_is_past_sticking_point&&!isSticky($parent_column);const scroll_position_is_above_sticking_point=scrolled_distance<vertical_scroll_position_to_start_sticking;const parent_column_is_positioned_below_bottom_sticking_point=parent_column_bottom_sticky_position<$parent_column.offset().top;const ad_position_is_lower_than_min_distance_allowed=($large_sidebar_ad.offset().top-scrolled_distance)>sidebar_ad_min_distance_from_top;if(parent_column_position_is_past_sticking_point_and_not_yet_sticky){makeColumnSticky($parent_column,parent_column_top_sticky_position);}
else if(isSticky($parent_column)){if(scroll_position_is_above_sticking_point){unstickColumn($parent_column);}
else if(parent_column_is_positioned_below_bottom_sticking_point){makeColumnStickToBottom($parent_column);}
else if(ad_position_is_lower_than_min_distance_allowed){$parent_column.removeClass('stickySidebarAd--bottom');makeColumnSticky($parent_column,parent_column_top_sticky_position);}}}
resetVars();$(window).on('resize',_.debounce(resetVarsAndAdjustPosition,250));$(window).on('scroll',_.throttle(onScroll,50));}
$('.large_sidebar_ad').each(function(idx,el){init($(el));});});})(jQuery);